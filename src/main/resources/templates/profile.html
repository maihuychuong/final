<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Th√¥ng tin t√†i kho·∫£n</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" />
    <!-- CSS ri√™ng cho profile -->
    <link rel="stylesheet" th:href="@{/css/profile.css}" />

    <!-- Google Fonts: Roboto -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />

    <!-- FontAwesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
</head>
<body>

<!-- N√∫t Trang ch·ªß -->
<a href="/" class="btn btn-light shadow-sm btn-home">
    <i class="fa-solid fa-house me-1"></i> Trang ch·ªß
</a>

<!-- Container ch√≠nh, cƒÉn gi·ªØa d·ªçc v√† ngang m√†n h√¨nh -->
<div class="d-flex justify-content-center align-items-center min-vh-100">
    <div class="profile-container" style="max-width: 600px; width: 100%; padding: 30px; background: white; border-radius: 12px; box-shadow: 0 0 15px rgba(0,0,0,0.1);">

        <section class="profile-info">
        <h2 class="mb-4 text-center">üë§ Th√¥ng tin t√†i kho·∫£n</h2>

        <!-- Th√¥ng b√°o th√†nh c√¥ng ho·∫∑c l·ªói -->
        <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
        <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

        <!-- Form c·∫≠p nh·∫≠t th√¥ng tin -->
        <form th:action="@{/profile}" th:object="${user}" method="post" class="d-flex flex-column gap-3">

            <div class="row align-items-center mb-3">
                <label for="username" class="col-sm-4 col-form-label">T√™n ƒëƒÉng nh·∫≠p</label>
                <div class="col-sm-8">
                    <input
                            type="text"
                            id="username"
                            class="form-control"
                            th:field="*{username}"
                            disabled
                    />
                </div>
            </div>

            <div class="row align-items-center mb-3">
                <label for="fullName" class="col-sm-4 col-form-label">H·ªç v√† t√™n</label>
                <div class="col-sm-8">
                    <input
                            type="text"
                            id="fullName"
                            class="form-control"
                            th:field="*{fullName}"
                            required
                    />
                </div>
            </div>

            <div class="row align-items-center mb-3">
                <label for="email" class="col-sm-4 col-form-label">Email</label>
                <div class="col-sm-8">
                    <input
                            type="email"
                            id="email"
                            class="form-control"
                            th:field="*{email}"
                            required
                    />
                </div>
            </div>

            <div class="row align-items-center mb-3">
                <label for="phoneNumber" class="col-sm-4 col-form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                <div class="col-sm-8">
                    <input
                            type="text"
                            id="phoneNumber"
                            class="form-control"
                            th:field="*{phoneNumber}"
                    />
                </div>
            </div>

            <div class="row align-items-center mb-3">
                <label for="createdAt" class="col-sm-4 col-form-label">Ng√†y t·∫°o t√†i kho·∫£n</label>
                <div class="col-sm-8">
                    <input
                            type="text"
                            id="createdAt"
                            class="form-control"
                            th:value="${#dates.format(user.createdAt, 'dd/MM/yyyy HH:mm:ss')}"
                            disabled
                    />
                </div>
            </div>

            <button type="submit" class="btn btn-primary">üíæ C·∫≠p nh·∫≠t</button>
        </form>
        </section>

        <!-- Ph·∫ßn ƒë√°nh gi√° ƒë√£ vi·∫øt -->
        <section class="review-section">
            <div th:if="${reviewSuccess}" class="alert alert-success" th:text="${reviewSuccess}"></div>
            <div th:if="${reviewError}" class="alert alert-danger" th:text="${reviewError}"></div>

        <div class="mt-5">
            <h3>üìù ƒê√°nh gi√° ƒë√£ vi·∫øt</h3>

            <div th:if="${#lists.isEmpty(reviews)}" class="alert alert-info">
                B·∫°n ch∆∞a vi·∫øt ƒë√°nh gi√° n√†o.
            </div>

            <div th:if="${!#lists.isEmpty(reviews)}">
                <div th:each="review : ${reviews}" class="card mb-3 shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title" th:text="${review.productName != null ? review.productName : 'S·∫£n ph·∫©m #' + review.productId}"></h5>
                        <p class="card-text">
                            <strong>‚≠ê ƒê√°nh gi√°:</strong> <span th:text="${review.rating}"></span><br />
                            <strong>üóíÔ∏è N·ªôi dung:</strong> <span th:text="${review.comment}"></span><br />
                            <strong>üïí Th·ªùi gian:</strong> <span th:text="${#temporals.format(review.createdAt, 'dd/MM/yyyy HH:mm')}"></span>
                        </p>

                        <div class="d-flex gap-2">
                            <a th:href="@{'/profile/reviews/edit/' + ${review.id}}" class="btn btn-sm btn-warning">‚úèÔ∏è S·ª≠a</a>
                            <a th:href="@{'/profile/reviews/delete/' + ${review.id}}"
                               class="btn btn-sm btn-danger"
                               onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën xo√° ƒë√°nh gi√° n√†y kh√¥ng?');">
                                üóëÔ∏è Xo√°
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </section>
    </div>
</div>

</body>
</html>